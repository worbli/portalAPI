openapi: "3.0.0"
info:
  version: 1.0.0
  title: Worbli API
  description: Worbli Portal API
  termsOfService: http://worbli.io/terms/
  contact:
    name: Worbli API Team
    email: info@worbli.io
    url: http://worbli.io
  license:
    name: Apache 2.0
    url: https://www.apache.org/licenses/LICENSE-2.0.html
servers:
  - url: '{Protocol}://{Environment}/api/{Version}'
    variables:
      Protocol:
        enum:
          - http
          - https
        default: https
      Environment:
          enum:
            - dev-api.worbli.io
            - uat-api.worbli.io
            - localhost:9000
          default: dev-api.worbli.io
      Version:
          enum:
            - v1
            - v2
            - v3
          default: v3
paths:
  /visitor/signin:
    post:
      tags:
        - Visitors
      requestBody:
        description: Login credentials
        required: true
        content:
          application/json:
            schema:
              required:
                - email
                - password
              properties:
                email: 
                  type: string
                password:
                  type: string
            example:
              email: test@worbli.io
              password: password1234!

      responses:
        '200':
          description: login success
          content:
            application/json:
              schema:
                required:
                  - data
                  - token
                properties:
                  data: 
                    type: boolean
                  token:
                    type: string

              example:
                data: true
                token: eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiIxMjM0NTY3ODkwIiwibmFtZSI6IkpvaG4gRG9lIiwiaWF0IjoxNTE2MjM5MDIyfQ.SflKxwRJSMeKKF2QT4fwpMeJf36POk6yJV_adQssw5c  
        '400':
          description: bad request
          content:
            application/json:
              schema:
                required:
                  - status
                  - statusText
                  - errors
                properties:
                  status:
                    type: integer
                  statusText:
                    type: string
                  errors:
                    type: array
              example:
                status: 400
                statusText: "Bad Request"
                errors: [{"field":["email"],"location":"body","messages":["\"email\" must be a valid email"],"types":["string.email"]}]
        '409':
          description: user not verified
          content:
            application/json:
              schema:
                required:
                  - data
                  - error
                properties:
                  data: 
                    type: boolean
                  error:
                    type: string
              example:
                data: false
                error: "Please verify your email first"
        '401':
          description: login failed
          content:
            application/json:
              schema:
                required:
                  - data
                  - error
                properties:
                  data: 
                    type: boolean
                  error:
                    type: string
              example:
                data: false
                error: "Authentication error!"
  /visitor/join:
    post:
      tags:
        - Visitors
      requestBody:
        description: Join credentials
        required: true
        content:
          application/json:
            schema:
              required:
                - email
                - password
                - terms
              properties:
                email: 
                  type: string
                password:
                  type: string
                terms:
                  type: boolean
                marketing:
                  type: boolean
            example:
              email: test@worbli.io
              password: password1234!
              terms: true
              marketing: false
      responses:
        '200':
          description: join successful
          content:
            application/json:
              schema:
                required:
                  - data
                properties:
                  data: 
                    type: boolean
              example:
                data: true
        '400':
          description: bad request
          content:
            application/json:
              schema:
                required:
                  - data
                  - status
                  - statusText
                  - errors
                properties:
                  data: 
                    type: boolean
                  status:
                    type: integer
                  statusText:
                    type: string
                  errors:
                    type: array
              example:
                data: false
                status: 400
                statusText: "Bad Request"
                errors: [{"field":["agreedTerms"],"location":"body","messages":["\"agreedTerms\" must be one of [true]"],"types":["any.allowOnly"]}]
        '500':
          description: internal server failure
          content:
            application/json:
              schema:
                required:
                  - data
                  - error
                properties:
                  data: 
                    type: boolean
                  error:
                    type: string
              example:
                data: false
                error: Failed to send a verify email to test@worbli.io
  /visitor/forgot:
    post:
      tags:
        - Visitors
      requestBody:
        description: Visitor forgot password
        required: true
        content:
          application/json:
            schema:
              required:
                - email
              properties:
                email: 
                  type: string
            example:
              email: test@worbli.io
      responses:
        '200':
          description: password reset process initiated
          content:
            application/json:
              schema:
                required:
                  - data
                properties:
                  data: 
                    type: boolean
              example:
                data: true
        '400':
          description: bad request
          content:
            application/json:
              schema:
                required:
                  - data
                  - status
                  - statusText
                  - errors
                properties:
                  data: 
                    type: boolean
                  status:
                    type: integer
                  statusText:
                    type: string
                  errors:
                    type: array
              example:
                data: false
                status: 400
                statusText: Bad Request
                errors: [{"field":["agreedTerms"],"location":"body","messages":["\"agreedTerms\" must be one of [true]"],"types":["any.allowOnly"]}]
        '500':
          description: internal server failure
          content:
            application/json:
              schema:
                required:
                  - data
                  - error
                properties:
                  data: 
                    type: boolean
                  error:
                    type: string
              example:
                data: false
                error: Failed to send a password reset email to test@worbli.io
  /user/password:
    put:
      tags:
        - User
      parameters:
        - in: header
          name: Authorization
          description: Bearer jwtToken
          schema:
            type: string
          example:
            Authorization: Bearer jwttoken.sdfsdf.sdfsdf
          required: true

      requestBody:
        description: User sets a new password
        required: true
        content:
          application/json:
            schema:
              required:
                - password
              properties:
                password: 
                  type: string
            example:
              password: password1234!
      responses:
        '200':
          description: new password response
          content:
            application/json:
              schema:
                required:
                  - data
                properties:
                  data: 
                    type: boolean
              example:
                data: true

        '400':
          description: new password response
          content:
            application/json:
              schema:
                required:
                  - data
                properties:
                  data: 
                    type: boolean
              example:
                data: false
  /user/profile/{id}:
    get:
      tags:
        - User
      parameters:
        - in: header
          name: Authorization
          description: Bearer jwtToken
          schema:
            type: string
          example:
            Authorization: Bearer jwttoken.sdfsdf.sdfsdf
          required: true
        - in: path
          name: id
          description: Bearer jwtToken
          schema:
            type: string
          example:
            Authorization: Bearer jwttoken.sdfsdf.sdfsdf
          required: true

      responses:
        '200':
          description: new password response
          content:
            application/json:
              schema:
                required:
                  - email
                properties:
                  email: 
                    type: string
              example:
                email: test@worbli.io

        '400':
          description: new password response
          content:
            application/json:
              schema:
                required:
                  - data
                properties:
                  data: 
                    type: boolean
              example:
                data: false
  /user/profile:
    post:
      tags:
        - User
      parameters:
        - in: header
          name: Authorization
          description: Bearer jwtToken
          schema:
            type: string
          example:
            Authorization: Bearer jwttoken.sdfsdf.sdfsdf
          required: true
      requestBody:
        description: User saves their profile
        required: true
        content:
          application/json:
            schema:
              required:
                - email
                - password
                - newPassword
              properties:
                email: 
                  type: string
                password:
                  type: string
                newPassword:
                  type: boolean
            example:
              email: test@worbli.io
              password: password1234!
              newPassword: newPassword1234!

      responses:
        '200':
          description: save profile response
          content:
            application/json:
              schema:
                required:
                  - data
                properties:
                  data: 
                    type: boolean
              example:
                data: true

        '400':
          description: save profile response
          content:
            application/json:
              schema:
                required:
                  - data
                properties:
                  data: 
                    type: boolean
              example:
                data: false
  /user/verify:
    post:
      tags:
        - User
      parameters:
        - in: header
          name: Authorization
          description: Bearer jwtToken
          schema:
            type: string
          example:
            Authorization: Bearer jwttoken.sdfsdf.sdfsdf
          required: true

      responses:
        '200':
          description: verify email response
          content:
            application/json:
              schema:
                required:
                  - data
                properties:
                  data: 
                    type: boolean
              example:
                data: true

        '400':
          description: verify email response
          content:
            application/json:
              schema:
                required:
                  - data
                properties:
                  data: 
                    type: boolean
              example:
                data: false
  /identity/image:
  # todo: add image upload
    post:
      tags:
        - Identity
      parameters:
        - in: header
          name: Authorization
          description: Bearer jwtToken
          schema:
            type: string
          example:
            Authorization: Bearer jwttoken.sdfsdf.sdfsdf
          required: true

      responses:
        '200':
          description: verify email response
          content:
            application/json:
              schema:
                required:
                  - data
                properties:
                  data: 
                    type: boolean
              example:
                data: true

        '400':
          description: verify email response
          content:
            application/json:
              schema:
                required:
                  - data
                properties:
                  data: 
                    type: boolean
              example:
                data: false
  /identity/application:
    # todo: add json in requestBody
    post:
      tags:
        - Identity
      parameters:
        - in: header
          name: Authorization
          description: Bearer jwtToken
          schema:
            type: string
          example:
            Authorization: Bearer jwttoken.sdfsdf.sdfsdf
          required: true

      responses:
        '200':
          description: verify email response
          content:
            application/json:
              schema:
                required:
                  - data
                properties:
                  data: 
                    type: boolean
              example:
                data: true

        '400':
          description: verify email response
          content:
            application/json:
              schema:
                required:
                  - data
                properties:
                  data: 
                    type: boolean
              example:
                data: false
  /identity/documents:
    # todo: add country paremeter in header
    get:
      tags:
        - Identity
      parameters:
        - in: header
          name: Authorization
          description: Bearer jwtToken
          schema:
            type: string
          example:
            Authorization: Bearer jwttoken.sdfsdf.sdfsdf
          required: true

      responses:
        '200':
          description: verify email response
          content:
            application/json:
              schema:
                required:
                  - data
                properties:
                  data: 
                    type: boolean
              example:
                data: true

        '400':
          description: verify email response
          content:
            application/json:
              schema:
                required:
                  - data
                properties:
                  data: 
                    type: boolean
              example:
                data: false
  /network/account:
    # todo: add country paremeter in header
    post:
      tags:
        - Network
      parameters:
        - in: header
          name: Authorization
          description: Bearer jwtToken
          schema:
            type: string
          example:
            Authorization: Bearer jwttoken.sdfsdf.sdfsdf
          required: true

      responses:
        '200':
          description: verify email response
          content:
            application/json:
              schema:
                required:
                  - data
                properties:
                  data: 
                    type: boolean
              example:
                data: true

        '400':
          description: verify email response
          content:
            application/json:
              schema:
                required:
                  - data
                properties:
                  data: 
                    type: boolean
              example:
                data: false
  /network/check:
    # todo: add name paremeter in header
    post:
      tags:
        - Network
      parameters:
        - in: header
          name: Authorization
          description: Bearer jwtToken
          schema:
            type: string
          example:
            Authorization: Bearer jwttoken.sdfsdf.sdfsdf
          required: true

      responses:
        '200':
          description: verify email response
          content:
            application/json:
              schema:
                required:
                  - data
                properties:
                  data: 
                    type: boolean
              example:
                data: true

        '400':
          description: verify email response
          content:
            application/json:
              schema:
                required:
                  - data
                properties:
                  data: 
                    type: boolean
              example:
                data: false
  /user/state:
    # todo: add id paremeter in header
    get:
      tags:
        - User
      parameters:
        - in: header
          name: Authorization
          description: Bearer jwtToken
          schema:
            type: string
          example:
            Authorization: Bearer jwttoken.sdfsdf.sdfsdf
          required: true

      responses:
        '200':
          description: verify email response
          content:
            application/json:
              schema:
                required:
                  - data
                properties:
                  data: 
                    type: boolean
              example:
                data: true

        '400':
          description: verify email response
          content:
            application/json:
              schema:
                required:
                  - data
                properties:
                  data: 
                    type: boolean
              example:
                data: false



  /mobile/sms:
    # todo: add name paremeter in header
    post:
      tags:
        - Mobile
      parameters:
        - in: header
          name: Authorization
          description: Bearer jwtToken
          schema:
            type: string
          example:
            Authorization: Bearer jwttoken.sdfsdf.sdfsdf
          required: true

      responses:
        '200':
          description: sms sent recipt
          content:
            application/json:
              schema:
                required:
                  - data
                properties:
                  data: 
                    type: boolean
              example:
                data: true

        '400':
          description: sms sent recipt
          content:
            application/json:
              schema:
                required:
                  - data
                properties:
                  data: 
                    type: boolean
              example:
                data: false
  /mobile/shortcode:
    get:
      tags:
        - Mobile
      parameters:
        - in: header
          name: Authorization
          description: Bearer jwtToken
          schema:
            type: string
          example:
            Authorization: Bearer jwttoken.sdfsdf.sdfsdf
          required: true

      responses:
        '200':
          description: get shortcode
          content:
            application/json:
              schema:
                required:
                  - data
                properties:
                  data: 
                    type: boolean
              example:
                data: true

        '400':
          description: get shortcode
          content:
            application/json:
              schema:
                required:
                  - data
                properties:
                  data: 
                    type: boolean
              example:
                data: false

        
  /health/ready:
    # todo: fix this up
    get:
      tags:
        - Health
      parameters:
        - in: header
          name: Authorization
          description: Bearer jwtToken
          schema:
            type: string
          example:
            Authorization: Bearer jwttoken.sdfsdf.sdfsdf
          required: true

      responses:
        '200':
          description: verify email response
          content:
            application/json:
              schema:
                required:
                  - data
                properties:
                  data: 
                    type: boolean
              example:
                data: true

        '400':
          description: verify email response
          content:
            application/json:
              schema:
                required:
                  - data
                properties:
                  data: 
                    type: boolean
              example:
                data: false
  /health/live:
    # todo: fix this up
    get:
      tags:
        - Health
      parameters:
        - in: header
          name: Authorization
          description: Bearer jwtToken
          schema:
            type: string
          example:
            Authorization: Bearer jwttoken.sdfsdf.sdfsdf
          required: true

      responses:
        '200':
          description: verify email response
          content:
            application/json:
              schema:
                required:
                  - data
                properties:
                  data: 
                    type: boolean
              example:
                data: true

        '400':
          description: verify email response
          content:
            application/json:
              schema:
                required:
                  - data
                properties:
                  data: 
                    type: boolean
              example:
                data: false 